---
title: 处理存的字段（点赞的情况，一个人不能重复点赞）
date: 2018-06-22 18:30:58
categories:
	- java
tags:
	- 备忘代码
---

代码背景描述：

一个字段值为"cardUrl":"card1 card2 card3",
修改这个字段，如果已经存在则删除，如果不存在，就做添加


```
Map retMap = getDiscoveryInfoById(params.get("discoveryId"));
        if (!retMap.isEmpty()) {
            //判断不包含点赞者cardUrl字段,或者字段值为空,则直接添加，
            // 如果已经有点赞者字段值，则进行字段的处理
            if (retMap.containsKey("praise") && StringUtils.isNotEmpty((String) retMap.get("praise"))) {
                String praiseCardUrl = (String) retMap.get("praise");
                List<String> praiseCardUrlNew = new ArrayList();
                String[] praiseCardUrlArr = praiseCardUrl.split(" ");
                praiseCardUrlNew = new ArrayList(Arrays.asList(praiseCardUrlArr));
                if (praiseCardUrlNew.size() > 0) {
                    //判断是否已经是点赞者，如果是，则删除，如果不是，则添加
                    if (!praiseCardUrlNew.contains(cardUrl)) {
                        praiseCardUrlNew.add(cardUrl);
                    } else {
                        for (String ss : praiseCardUrlNew) {
                            if (ss.equals(cardUrl)) {
                                praiseCardUrlNew.remove(ss);
                                break;
                            }
                        }
                    }
                }
                String praise = StringUtils.join(praiseCardUrlNew.toArray(), " ");
                params.put("praise", praise);
            } else {
                params.put("praise", cardUrl);
            }
        }
```
