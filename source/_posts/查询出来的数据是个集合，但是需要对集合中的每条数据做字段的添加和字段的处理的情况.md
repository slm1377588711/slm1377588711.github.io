---
title: 查询出来的数据是个集合，但是需要对集合中的每条数据做字段的添加和字段的处理的情况
date: 2018-06-22 18:34:02
categories:
	- java
tags:
	- 备忘代码
---


 
```
Map retMap = ESUtil.selectEE(Constants.INDEX_DISCOVERY, Constants.ES_TYPE_DISCOVERY_INFO, rowMap,
                sortMap, null, termsMap);
            if (!retMap.isEmpty()) {
                List retList = (ArrayList) retMap.get("data");
                if (retList.size() > 0) {
                    for (int j = 0; j < retList.size(); j++) {
                        Map retOneDis = (HashMap) retList.get(j);
                        if (retOneDis.containsKey("discoveryImg") && StringUtils.isNotEmpty(retOneDis.get("discoveryImg").toString())) {
                            String discoveryImg = retOneDis.get("discoveryImg").toString();
                            List discoveryImgList = new ArrayList();
                            if (discoveryImg != null && StringUtils.isNotEmpty(discoveryImg)) {
                                String[] discoveryImgArr = discoveryImg.split(" ");
                                discoveryImgList = Arrays.asList(discoveryImgArr);
                                if (discoveryImgList == null) {
                                    discoveryImgList = new ArrayList();
                                }
                            }
                            retOneDis.put("discoveryImgList", discoveryImgList);
                        }
                        //获取商号头像和名称
                        String companyId = (String) retOneDis.get("companyId");
                        List list = companyService.loadCompanyImgAndName(companyId);
                        if (list != null && list.size() > 0) {
                            Map map = (Map) list.get(0);
                            if (map.containsKey("headimgurl")) {
                                retOneDis.put("companyImg", map.get("headimgurl"));
                            }
                            if (map.containsKey("companyName")) {
                                retOneDis.put("companyName", map.get("companyName"));
                            }
                        }
                        //添加权限字段
                        for (int k = 0; k < checkAdminList.size(); k++) {
                            Map chckRetMap = (HashMap) checkAdminList.get(k);
                            String checkCompanyId = (String) chckRetMap.get("companyId");
                            if (companyId.equals(checkCompanyId)) {
                                retOneDis.put("isAdmin", chckRetMap.get("isAdmin"));
                                break;
                            }
                        }
                        retMapList.add(retOneDis);
                    }
                }
            }
```
